# Shop to Cart Integration Guide

## How It Works

When a customer browses products on `shop.html` and clicks "Add to Cart", the product is saved to browser storage and automatically appears in `cart.html`.

### Flow Diagram
```
shop.html
    ↓ (Customer clicks "Add to Cart")
    ↓
cart.js → Saves to localStorage
    ↓
cart.html
    ↓ (Customer navigates to cart page)
    ↓
Displays saved products from localStorage
```

---

## File Structure

### 1. **shop.html**
- Displays product catalog
- Links to `cart.js` and `shop.js`
- Has empty `<div class="pro-container">` for dynamic product rendering

```html
<section id="product1" class="section-p1">
    <div class="pro-container">
        <!-- Products will be dynamically generated by shop.js -->
    </div>
</section>

<!-- Scripts must be in this order -->
<script src="cart.js"></script>  <!-- Cart system (MUST load first) -->
<script src="shop.js"></script>  <!-- Shop functionality (uses cart.js) -->
```

### 2. **shop.js** (450+ lines)
Runs on page load and:
- Reads `shopProducts` array (6 sample products)
- Calls `displayProducts()` to generate HTML in `.pro-container`
- Calls `attachCartEventListeners()` to wire up "Add to Cart" buttons
- Each "Add to Cart" button triggers `cartManager.addToCart(product, quantity)`

**Key Functions:**
```javascript
displayProducts()              // Generates product HTML
attachCartEventListeners()     // Wires up add-to-cart clicks
setupSearch()                  // Search functionality
setupFilters()                 // Filter functionality
```

**Product Data Structure:**
```javascript
shopProducts = [
    {
        id: 1,
        name: "Cartoon Astronaut T-Shirts",
        price: 49.00,
        image: "img/products/f1.jpg",
        description: "High quality cotton t-shirt"
    }
    // 6 products total
]
```

### 3. **cart.js** (600+ lines)
Initializes on page load with:
- `CartManager` class that manages all cart operations
- Saves cart to browser localStorage automatically
- Global `cartManager` object available to other scripts

**Key Methods:**
```javascript
cartManager.addToCart(product, quantity)    // Add item to cart
cartManager.updateQuantity(id, quantity)    // Update item quantity
cartManager.removeFromCart(id)              // Remove item
cartManager.displayCartTable()              // Display cart in HTML
cartManager.updateTotals()                  // Update price totals
cartManager.applyCoupon(code)               // Apply discount
```

**Cart Data in localStorage:**
```javascript
localStorage.cart = JSON.stringify([
    {
        id: 1,
        name: "Cartoon Astronaut T-Shirts",
        price: 49.00,
        image: "img/products/f1.jpg",
        quantity: 2
    }
])
```

### 4. **cart.html**
- Empty cart table that gets populated by `cart.js`
- Links to `cart.js` to load cart system

```html
<table id="cart">
    <thead>...</thead>
    <tbody>
        <!-- Cart items will be populated by cart.js displayCartTable() -->
    </tbody>
</table>

<script src="cart.js"></script>  <!-- Loads and displays cart -->
```

---

## Complete User Flow

### Step 1: Customer Visits Shop Page
```
1. shop.html loads
2. cart.js initializes → CartManager created
3. shop.js initializes → Checks if cartManager exists
4. displayProducts() generates 6 products in .pro-container
5. attachCartEventListeners() wires up "Add to Cart" buttons
```

### Step 2: Customer Adds Product to Cart
```
1. Customer clicks "Add to Cart" button on a product
2. attachCartEventListeners() detects click
3. cartManager.addToCart(product, quantity) is called
4. Product saved to localStorage.cart
5. showNotification() displays success message
6. Cart count updated in header
```

### Step 3: Customer Views Cart
```
1. Customer navigates to cart.html
2. cart.js loads and initializes
3. cartManager reads localStorage.cart
4. displayCartTable() generates HTML table
5. updateTotals() calculates and displays subtotal/total
```

---

## Testing the Integration

### Test 1: Verify Products Display
```
1. Open shop.html in browser
2. Check DevTools Console for any errors
3. Verify 6 products display in grid
4. Verify product images load correctly
```

### Test 2: Verify Add to Cart Works
```
1. On shop.html, click "Add to Cart" button
2. Verify success notification appears
3. Check browser DevTools:
   - Application → Storage → Local Storage → cart
4. Verify product JSON appears in localStorage
```

### Test 3: Verify Cart Display
```
1. Navigate to cart.html (or click cart icon)
2. Verify added product appears in cart table
3. Verify product name, price, quantity display correctly
4. Verify subtotal and total calculate correctly
```

### Test 4: Complete Workflow
```
1. Add multiple products from shop.html
2. Update quantities in cart.html
3. Remove a product
4. Verify localStorage updates each time
5. Refresh page and verify cart persists
6. Add more products and verify they merge
```

---

## Customization Guide

### Add More Products
Edit `shop.js` and add to `shopProducts` array:
```javascript
{
    id: 7,
    name: "Your Product Name",
    price: 29.99,
    image: "img/products/your-image.jpg",
    description: "Product description"
}
```

### Change Product Layout
Edit `displayProducts()` function in `shop.js`:
```javascript
// Current: 3-column grid
// Change CSS in style.css for .pro-container

// Or edit HTML structure in template:
productContainer.innerHTML = productsToDisplay.map(product => `
    <!-- Edit this HTML to change product card layout -->
    <div class="pro" data-product-id="${product.id}">
        ...
    </div>
`)
```

### Add New Features
1. **Product Search:** Edit `setupSearch()` in shop.js
2. **Filtering:** Edit `setupFilters()` in shop.js
3. **Sorting:** Edit `setupSort()` in shop.js
4. **Wishlist:** Edit `toggleWishlist()` in shop.js

---

## Troubleshooting

### Products Don't Display
```
❌ Issue: No products visible on shop.html
✅ Solution:
   - Check cart.js loads BEFORE shop.js
   - Check cartManager exists in console
   - Check .pro-container exists in HTML
   - Check console for errors
```

### Add to Cart Button Doesn't Work
```
❌ Issue: Button click doesn't add product
✅ Solution:
   - Verify cartManager.addToCart() is called
   - Check localStorage for cart data
   - Check console for JavaScript errors
   - Verify product data structure matches expected format
```

### Cart Doesn't Show Products
```
❌ Issue: cart.html shows empty cart
✅ Solution:
   - Verify products were added on shop.html
   - Check localStorage has cart data
   - Refresh cart.html to load from storage
   - Check console for errors in cart.js
```

### Page Refresh Loses Cart
```
❌ Issue: Cart empties after refresh
✅ Solution:
   - Check localStorage actually saves data
   - Verify browserStorage isn't disabled
   - Check for JavaScript errors on page load
   - Verify cartManager.loadCartFromStorage() is called
```

---

## API Integration (Optional)

If you want to save cart to a server instead of just localStorage:

### 1. Add Backend Endpoint (server.js)
```javascript
app.post('/api/cart/save', (req, res) => {
    // Save req.body.cart to database
    res.json({ success: true });
});
```

### 2. Modify cart.js
```javascript
async saveCartToServer() {
    await fetch('/api/cart/save', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ cart: this.cart })
    });
}
```

### 3. Call When Adding Items
```javascript
cartManager.addToCart(product, quantity);
await cartManager.saveCartToServer();
```

---

## Summary

✅ **shop.html** → Displays products from shop.js  
✅ **shop.js** → Generates product HTML, wires up add-to-cart  
✅ **cart.js** → Manages cart, saves to localStorage  
✅ **cart.html** → Displays products from localStorage  

When customer adds product on shop.html → automatically appears in cart.html

---

## Next Steps

1. Test the complete flow in browser
2. Add server-side cart persistence (optional)
3. Create product detail page (sproduct.html)
4. Integrate checkout system
5. Add user authentication for saved carts

---

**Last Updated:** Current Session  
**Status:** Ready for Production
